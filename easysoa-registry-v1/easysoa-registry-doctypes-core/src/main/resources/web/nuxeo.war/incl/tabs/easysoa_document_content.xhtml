<div xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:nxu="http://nuxeo.org/nxweb/util">

  <c:if test="false">
   Include document listing and summary view in the same tab
  </c:if>
  
  <!-- Contents listing -->
  <ui:include src="/incl/tabs/document_content.xhtml" />

  <!-- SoaNode parents -->
  <ui:include src="/incl/easysoa_soanode_parents.xhtml" />

  <!--  Display metadata, including for folderish documents -->
  <nxu:set var="summaryLayouts"
           value="#{nxd:typeInfo(currentDocument).getLayouts('summary', null)}"
           cache="true">

    <c:if test="#{not empty summaryLayouts}">

      <c:if test="false">
        Since 5.7: compatibility code for old layout contributions to the
        "summary" document mode
      </c:if>

      <h:form id="document_view" enctype="multipart/form-data">
        <a4j:region id="documentViewRegion">
          <a4j:outputPanel id="documentViewPanel">
            <nxl:documentLayout documentMode="summary" mode="view"
                                value="#{currentDocument}"
                                includeAnyMode="false"/>
          </a4j:outputPanel>
        </a4j:region>
      </h:form>

    </c:if>

    <c:if test="#{empty summaryLayouts}">
      <a4j:region id="documentViewRegion">
        <a4j:outputPanel id="documentViewPanel">
          <nxl:documentLayout documentMode="grid_summary" mode="view"
                              value="#{currentDocument}" defaultLayout="grid_summary_layout"
                              includeAnyMode="false"/>
        </a4j:outputPanel>
      </a4j:region>
    </c:if>
  </nxu:set>
    
</div>
