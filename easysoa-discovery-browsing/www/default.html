<html>
<head>
<script type="text/javascript" src="/lib/jquery.js"></script>

<!-- Special style for Easysoa notification button -->
<style rel="stylesheet" type="text/css">
   .button {
    font: bold 15px Arial;
    text-decoration: none;
    background-color: #EEEEEE;
    color: #333333;
    padding: 2px 6px 2px 6px;
    border-top: 1px solid #CCCCCC;
    border-right: 1px solid #333333;
    border-bottom: 1px solid #333333;
    border-left: 1px solid #CCCCCC;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    icon: url("/img/favicon.png");
   }
</style>

<!--
<style type="text/css">
div.image {
	width:            100px;
	height:           100px;
	background-image: url('data:image/png;base64,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');
}
</style>
-->

<!--<script>
  top["webDiscoveryBookmarklet@easysoa.org"] = ''
    +'<!DOCTYPE html>'
    +'<html>'
      +'<head>'
        +'<title>Web discovery bookmarklet</title>'
        +'<link rel="icon" href="/img/favicon.png" />'
      +'</head>'
      +'<body>'
        +'<script>'
          +'window.onload=function(){'
            +'window.setTimeout(function(){'
              +'history.back();'
            +'},250);'
          +'};'
        +'</scr'+'ipt>'
      +'</body>'
    +'</html>'
  ;
</script>-->

<script type="text/javascript">

function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++) {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

$(document).ready(function() {

  // Display the current context
  /*if(typeof getUrlVars()["subprojectId"] != "undefined"){
    $('#context').html(decodeURI(getUrlVars()["subprojectId"]));
  }*/

  /**
   * Load bookmarklet script
   */

  //alert('ajax url : /js/bookmarklet/bookmarklet-min.js?subprojectId=' + decodeURI(getUrlVars()["subprojectId"])); // OK
  $.ajax({
    url: '/js/bookmarklet/bookmarklet-min.js?subprojectId=' + decodeURI(getUrlVars()["subprojectId"]) + "&visibility=" + getUrlVars()["visibility"],
    dataType: 'text', // Prevents JS execution
    success: function(data, status, xhr) {
      ///alert('ajax response : ' + xhr.responseText); // OK
      var js = encodeURI(xhr.responseText); // and not escape(), else é becomes %E9 (from UTF-8 u+00e9) instead of %C3%A9 (E9 encoded as 2 UTF-8 bytes), see http://stackoverflow.com/questions/5300803/how-to-encode-a-url-with-accent-characters-in-javascript
      //var faviconCode = "<!DOCTYPE html><html><head><title>Notifier EasySOA</title><link rel=”icon” type=”image/png” href=”/img/favicon.png”/></head><body>Notifier EasySOA</body></html> ";
      if (xhr.responseText.substr(0, 11) != 'javascript:') {
        js = 'javascript:' + js;
      }
      //alert('encoded : ' + encodeURI(xhr.responseText));
      //$('#bookmarklet').html('<a href="' + js + '">Find WSDLs</a>');
      $('#bookmarklet').html('<a class="button" href="' + js + '" title="Glissez moi dans les favoris de votre navigateur">Notifier EasySOA</a>');

      //$('#bookmarklet').html('<a class="button" ondragend="this.click();" href="javascript:if(top[\'webDiscoveryBookmarklet@easysoa.org\']){top[\'webDiscoveryBookmarklet@easysoa.org\'];}else{' + js + '}" title="Glissez moi dans les favoris de votre navigateur">Notifier EasySOA</a>');

    }
  });

});

</script>

</head>
<body style="font-family: Arial, sans-serif; color: #002244;">

<!--Perspective : <span id="context"></span>-->

<h2>Démarrage rapide</h2>
<p>
    La découverte web vous permet, tout en naviguant, de découvrir les services Web liés depuis les pages web visitées.

    Pour l'utiliser :
    <ol>
        <li><a href="#proxyConfig">configurez le proxy</a></li>
        <li>tapez l'url dans la barre <img src="/img/easysoa_url_bar.png" alt="Discovery url bar"/></li>
    </ol>

    <strong>ATTENTION !</strong> Ne s'applique pas aux sites sécurisés (protocole https), pour lesquels il est nécessaire de passer en mode notification <a href="#notifier">avec le bouton Notifier EasySOA</a>.
</p>

<hr/>
<hr/>

<!--<h2>Goal</h2>-->
<!--The goal is to help business users find and tag services that are interesting to them, by simply letting them browse the place they know best, where such services are most likely to be : their usual business applications and intranet.-->

<h2>Objectif</h2>
L'objectif de la découverte web est d'aider les utilisateurs à trouver et marquer les services qui sont interressant pour eux, en leur permettant simplement de naviguer sur les sites qu'ils connaissent le mieux et où de tels services sont les plus susceptibles d'être : leurs applications business habituelles et leur Intranet.

<!--<h2>How it works</h2>-->
<!--It takes the form of a 'browser in the browser'. It automatically finds WSDL files while the user navigates, extracts business information about it such as the business application where it was found (taken from the title of the browsed page), then makes him check all of it before sending the files to the Nuxeo repository.-->
<!-- To browse, just enter an URL in the white bar and it the "enter" key of your keyboard. This target web site is displayed above the barand the services are autommatically discovered and displayed at in the left frame. -->

<h2>Fonctionnement</h2>
<p>
La découverte web prend la forme d'un navigateur dans le navigateur. Il trouve automatiquement les fichiers WSDL pendant la navigation, en extrait les informations business telles que les applications metier ou ces fichiers ont été trouvés (tirée du titre de la page) et permet à l'utilisateur de vérifier les informations découvertes avant de les envoyer dans le registre Nuxeo.
</p>
<p>
Pour naviguer, entrez simplement une adresse (correspondant avotre application métier ou votre Intranet) dans le champ de saisie blanc et appuyez sur "entrée". le site ciblé s'affiche en dessous du champs et les services sont automatiquement découverts et affichés dans la partie gauche de l'écran.
</p>
<!--<img src="/img/easysoa_discovery_browsing.png" alt="Discovery browsing screenshot"/>-->

<!--<h2>How to configure your browser to use the discovery by browsing tool</h2>-->
<h2><a id="proxyConfig">Comment configurer votre navigateur pour utiliser la découverte web ?</a></h2>

    <!--The proxy will be launched on http://localhost:8081, so you will have to edit your browser's options to set the proxy to this address. Please make sure to remove any proxy exceptions (like localhost/127.0.0.1).

    If you are in Chrome browser and you don't discover any services or some authentication problems because of proxy configuration problems. Run :

    chromium-browser --proxy-server="127.0.0.1:8081" --proxy-bypass-list=""

    It will launch the browser with the good configuration.-->

    La découverte web fonctionne avec un proxy démarré à l'adresse http://localhost:8081, vous devez donc configurer votre navigateur pour qu'il utilise ce proxy. Veuillez à ce que toutes les exceptions soit retirées (Par exemple localhost/127.0.0.1).
    <br/>
    <br/>
    <img src="/img/firefoxProxy.png" alt="Firefox proxy configuration"/>
    <!--Si vous utilisez le navigateur Google Chrome et que vous ne découvrez aucun service or some authentication problems because of proxy configuration problems. Run :

    chromium-browser --proxy-server="127.0.0.1:8081" --proxy-bypass-list=""

    It will launch the browser with the good configuration.-->

<!--<h2>Getting started</h2>-->
<h2>Exemples</h2>
<!--<h2>Examples</h2>-->
<!--<a href="/examples.html">Here</a> you can find some sample pages or web sites containing services to browse.-->
<a href="/examples.html">Ici</a> vous pourrez trouver quelques pages d'exemples ou des sites contenant des services à découvrir.

<!--<h2>Bookmarklet</h2>-->
<h2><a id="notifier">Notification</a></h2>

<!--<p>If you need to browse to HTTPS places, our proxy will not work. Instead, try to drag this bookmarklet to your favorites: when you're on a page of interest (e.g. that contains links to WSDLs), click then on the bookmark to make EasySOA explore the page.</p>-->
<p>Si vous avez besoin de naviguer sur des sites HTTPS, Le proxy de découverte EasySOA ne va pas fonctionner. A la place, essayez d'ajouter ce bookmarklet dans les favoris de votre navigateur. Puis ouvrez une
autre fenêtre et naviguez sur une page contenant des liens vers des fichiers WSDL, cliquez sur le favori pour déclencher l'exploration de la page et la découverte des services.</p>


<!-- TODO set a button for notification -->
<!--<table border="0">
    <tr>
        <td width="20%"><p id="bookmarklet" style="font-size: 15pt"><i>(loading)</i></p></td>
        <td width="80%"><img src="/img/dragAndDropNotificationButton.gif" alt="Glisser/Déposer"/></td>
    </tr>
</table>-->

<p id="bookmarklet" style="font-size: 15pt"><i>(loading)</i></p>
<img src="/img/dragAndDropNotificationButton.gif" alt="Glisser/Déposer"/>

</body>
</html>

