<html>
<head>
<script type="text/javascript" src="/lib/jquery.js"></script>
<script type="text/javascript" src="/lib/i18next-1.7.1.js"></script><!-- .min -->
<script type="text/javascript" src="/js/common.js"></script>
<script type="text/javascript" src="js/utils.js"></script>

<!-- Special style for Easysoa notification button -->
<style rel="stylesheet" type="text/css">
   .button {
    font: bold 15px Arial;
    text-decoration: none;
    background-color: #EEEEEE;
    color: #333333;
    padding: 2px 6px 2px 6px;
    border-top: 1px solid #CCCCCC;
    border-right: 1px solid #333333;
    border-bottom: 1px solid #333333;
    border-left: 1px solid #CCCCCC;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    icon: url("/img/favicon.png");
   }
</style>

<!--
<style type="text/css">
div.image {
	width:            100px;
	height:           100px;
	background-image: url('data:image/png;base64,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');
}
</style>
-->

<!--<script>
  top["webDiscoveryBookmarklet@easysoa.org"] = ''
    +'<!DOCTYPE html>'
    +'<html>'
      +'<head>'
        +'<title>Web discovery bookmarklet</title>'
        +'<link rel="icon" href="/img/favicon.png" />'
      +'</head>'
      +'<body>'
        +'<script>'
          +'window.onload=function(){'
            +'window.setTimeout(function(){'
              +'history.back();'
            +'},250);'
          +'};'
        +'</scr'+'ipt>'
      +'</body>'
    +'</html>'
  ;
</script>-->

<script type="text/javascript">
/*
// i18n using polyglot.js NO DOESN'T FEATURE REPLACING KEYS IN HTML
var polyglot = new Polyglot();
var detectedLanguage = navigator.language || navigator.userLanguage;
var languageFilePrefix = "messages.";
var defaultLanguageFile = languageFilePrefix + "en_US.js";
var supportedLanguages = [ "en", "fr" ];
var language = supportedLanguages[0];
if (language != null && language.length >= 2
		&& supportedLanguages.indexOf(detectedLanguage.substring(0, 2) > -1){
	language = detectedLanguage.substring(0, 2);
   file = languageFilePrefix + language + ".js";
   //polyglot.locale('US');  // useful for pluralization
}
var url = "<script type=\"text/javascript\" src=\"js/i18n/" + file + "\"></"
    + "script>";  //directory with your translation files
$('head').append(url);
*/

function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++) {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

$(document).ready(function() {
	// i18n using i18next.js
	i18n.init({ fallbackLng: 'en_US' }, // else default fallback language is dev
	    function() {
           $(document.body).i18n();
           
           initDefault();
	    }
	);
});

function initDefault() {
	initLinksI18n(); // i18n links
	
  // Display the current context
  /*if(typeof getUrlVars()["subprojectId"] != "undefined"){
    $('#context').html(decodeURIComponent(getUrlVars()["subprojectId"]));
  }*/

  /**
   * Load bookmarklet script
   */

  //alert('ajax url : /js/bookmarklet/bookmarklet-min.js?subprojectId=' + decodeURI(getUrlVars()["subprojectId"])); // OK
  $.ajax({
    url: '/js/bookmarklet/bookmarklet-min.js?subprojectId=' + decodeURIComponent(getUrlVars()["subprojectId"])
    		+ "&visibility=" + getUrlVars()["visibility"]
         + "&registryServerName=" + getUrlVars()['registryServerName']
         + "&setLng=" + i18n.lng(),
    dataType: 'text', // Prevents JS execution
    invokedata: {
        host: getUrlVars()['registryServerName'],
        subprojectId: decodeURIComponent(getUrlVars()["subprojectId"]),
        setLng: i18n.lng(),
    },
    success: function(data, status, xhr) {
      ///alert('ajax response : ' + xhr.responseText); // OK
      var js = encodeURI(xhr.responseText); // and not escape(), else é becomes %E9 (from UTF-8 u+00e9)
          // instead of %C3%A9 (E9 encoded as 2 UTF-8 bytes), see http://stackoverflow.com/questions/5300803/how-to-encode-a-url-with-accent-characters-in-javascript
      //var faviconCode = "<!DOCTYPE html><html><head><title>Notifier EasySOA</title><link rel=”icon” type=”image/png” href=”/img/favicon.png”/></head><body>Notifier EasySOA</body></html> ";
      if (xhr.responseText.substr(0, 11) != 'javascript:') {
        js = 'javascript:' + js;
      }
      //alert('encoded : ' + encodeURI(xhr.responseText));

      //var bookmarkletLink = '<a class="button" href="' + js + '" title="'
      //   + polyglot.t("NotifyEasySOA.tooltip") + '>' + polyglot.t("NotifyEasySOA");
      var bookmarkletLink = '<a class="button" href="' + js + '" title="'
         + i18n.t("default.NotifyEasySOA_tooltip") + '">' + i18n.t("default.NotifyEasySOA");
      if("" !== this.invokedata.host){
          bookmarkletLink = bookmarkletLink + ' (' + this.invokedata.host + ')';
      }
      if("" !== this.invokedata.subprojectId){
        $('#bookmarklet').html(bookmarkletLink + ' ' + i18n.t("default.in") + ' '
        		+ formatPhaseForDisplay(this.invokedata.subprojectId) +'</a>');
      } else {
        $('#bookmarklet').html(bookmarkletLink + '</a>');
      }

      if("" !== this.invokedata.host){
    	  $('#proxyAddress').html('<a href="http://' + this.invokedata.host
    			  + ':8081">http://' + this.invokedata.host + ':8081</a>');
      }
    }
  });

}

</script>

</head>
<body style="font-family: Arial, sans-serif; color: #002244;">

<!--Perspective : <span id="context"></span>-->

<!-- a href="./?setLng=en-US">en-US</a> | <a href="./?setLng=fr-FR">fr-FR</a -->

<h2 data-i18n="default.Quickstart">NOT TRANSLATED Démarrage rapide</h2>
<p>
    <span data-i18n="default.intro">
    La découverte web vous permet, tout en naviguant, de découvrir les services Web liés
    depuis les pages web visitées.

    Pour l'utiliser :
    </span>
    <ol>
        <li><a href="#proxyConfig" data-i18n="default.confProxy">NOT TRANSLATED configurez le proxy</a></li>
        <li><span data-i18n="default.url">tapez l'URL dans la barre</span>
            <img src="/img/easysoa_url_bar.png" alt="Discovery url bar"/></li>
    </ol>

    <strong data-i18n="default.warning">ATTENTION !</strong>
    <span data-i18n="default.warningSecure">
    Ne s'applique pas aux sites sécurisés (protocole https),
    pour lesquels il est nécessaire de passer en mode notification
    </span>
    <a href="#notifier" data-i18n="default.withNotify">avec le bouton Notifier EasySOA</a>.
</p>

<hr/>
<hr/>

<h2 data-i18n="default.goal">Objectif</h2>
<span data-i18n="default.goalText">
L'objectif de la découverte web est d'aider les utilisateurs à trouver et marquer les
services qui sont interressant pour eux, en leur permettant simplement de naviguer sur les
sites qu'ils connaissent le mieux et où de tels services sont les plus susceptibles d'être :
leurs applications business habituelles et leur Intranet.
</span>

<h2 data-i18n="default.how">Fonctionnement</h2>
<p data-i18n="default.howText1">
La découverte web prend la forme d'un navigateur dans le navigateur. Il trouve automatiquement
les fichiers WSDL pendant la navigation, en extrait les informations business telles que les
applications metier ou ces fichiers ont été trouvés (tirée du titre de la page) et permet à
l'utilisateur de vérifier les informations découvertes avant de les envoyer dans le registre Nuxeo.
</p>
<p data-i18n="default.howText2">
Pour naviguer, entrez simplement une adresse (correspondant avotre application métier ou votre
Intranet) dans le champ de saisie blanc et appuyez sur "entrée". le site ciblé s'affiche en
dessous du champs et les services sont automatiquement découverts et affichés dans la partie
gauche de l'écran.
</p>
<!--<img src="/img/easysoa_discovery_browsing.png" alt="Discovery browsing screenshot"/>-->

<h2><a id="proxyConfig" data-i18n="default.howToConf">Comment configurer votre navigateur pour utiliser la découverte web ?</a></h2>

    <span data-i18n="default.howToConfText1">
    La découverte web fonctionne avec un proxy démarré à l'adresse,
    </span>
    <span id="proxyAddress"><i data-i18n="default.loading">(loading)</i></span>,
    <span data-i18n="default.howToConfText2">
    vous devez donc configurer votre navigateur pour qu'il utilise ce proxy. Veuillez à ce
    que toutes les exceptions soit retirées (par exemple localhost/127.0.0.1 si l'adresse
    du proxy est http://localhost:8081 ou http://127.0.0.1:8081).
    </span>
    <br/>
    <br/>
    <img src="/img/firefoxProxy.png" alt="Firefox proxy configuration"/>
    <br/>
    <br/>
    <span data-i18n="default.howToConfChrome1">
    Si vous utilisez le navigateur Google Chrome et que vous ne découvrez aucun service
    ou avez des problèmes d'authentification à cause du proxy, lancez :
    </span>
    
    <pre>chromium-browser --proxy-server="127.0.0.1:8081" --proxy-bypass-list=""</pre>
    
    <span data-i18n="default.howToConfChrome2">
    Cela démarrera le navigateur avec la bonne configuration.
    </span>

<h2 data-i18n="default.examples">Exemples</h2>
<a href="/examples.html" class="i18n" data-i18n="default.here">Ici</a><!-- NB. i18n'd in common.js -->
<span data-i18n="default.youCanFindSamples">
vous pourrez trouver quelques pages d'exemples ou des
sites contenant des services à découvrir.
</span>

<h2><a id="notifier" data-i18n="default.notify">Notification</a></h2>

<p data-i18n="default.notifyText">
Si vous avez besoin de naviguer sur des sites HTTPS, le proxy de découverte EasySOA ne va pas fonctionner.
A la place, essayez d'ajouter ce bookmarklet dans les favoris de votre navigateur. Puis ouvrez une
autre fenêtre et naviguez sur une page contenant des liens vers des fichiers WSDL, cliquez sur le favori
pour déclencher l'exploration de la page et la découverte des services.
</p>


<!-- TODO set a button for notification -->
<!--<table border="0">
    <tr>
        <td width="20%"><p id="bookmarklet" style="font-size: 15pt"><i>(loading)</i></p></td>
        <td width="80%"><img src="/img/dragAndDropNotificationButton.gif" alt="Glisser/Déposer"/></td>
    </tr>
</table>-->

<p id="bookmarklet" style="font-size: 15pt"><i data-i18n="default.loading">(loading)</i></p>
<img src="/img/dragAndDropNotificationButton.png" alt="Glisser/Déposer"/>
<p>
<span data-i18n="default.alsoVideo">
Une vidéo d'explication détaillée est aussi disponible
</span>
<a href="/img/dragAndDropNotificationButton.gif" data-i18n="default.here">ici</a>.
</p>

</body>
</html>

